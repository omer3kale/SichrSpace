# ── SichrPlace — Beta MSSQL Profile ──
# Activate via environment: SPRING_PROFILES_ACTIVE=beta-mssql
#
# Points Spring Boot at the MSSQL container running on the DigitalOcean
# droplet.  ALL credentials come from environment variables.
#
# On the droplet, set these in /opt/sichrplace/.env:
#   BETA_DB_USER=sichrplace_user
#   BETA_DB_PASS=<generated password>
#   JWT_SECRET=<generated secret>
#
# Or if running inside docker-compose.mssql.yml, environment vars are
# injected automatically from the .env file.

spring:
  datasource:
    url: jdbc:sqlserver://${BETA_DB_HOST:database}:1433;databaseName=sichrplace;encrypt=false
    username: ${BETA_DB_USER}
    password: ${BETA_DB_PASS}
    driver-class-name: com.microsoft.sqlserver.jdbc.SQLServerDriver
    hikari:
      pool-name: SichrPlace-MSSQL-Beta
      maximum-pool-size: 10
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.SQLServerDialect

server:
  port: ${PORT:8080}

app:
  jwtSecret: ${JWT_SECRET}
  jwtExpirationMs: ${JWT_EXPIRATION:86400000}
  jwtRefreshExpirationMs: ${JWT_REFRESH_EXPIRATION:604800000}

  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:https://sichrplace.com,https://www.sichrplace.com}

# ── Teaching note ──
# Students: This profile is identical in structure to application-local-mssql.yml
# but uses BETA_DB_* env vars and points at a remote host instead of localhost.
# The JDBC URL, driver, and Hibernate dialect are the same — only the host changes.
#
# Compare the two files side-by-side:
#   local-mssql → localhost:1433          (your laptop)
#   beta-mssql  → ${BETA_DB_HOST}:1433   (DigitalOcean droplet)
#
# Question: Why does the beta profile have NO default values for username/password?

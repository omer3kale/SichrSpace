# ──────────────────────────────────────────────────────────────
# SichrPlace — COCO Rules (Code Coverage Objectives)
# Machine-readable thresholds for ./gradlew checkCoco
#
# Two tiers:
#   target       — enforceable NOW (CI gate, build fails below this)
#   aspiration   — goal once full test suite is written
#
# Current baseline: 15.3 % overall (70+ tests, Feb 2026)
# ──────────────────────────────────────────────────────────────

# Global minimum — weighted across all packages
overall:
  target: 12         # Enforceable now  (current: 15.3 %)
  aspiration: 85     # Goal with full test suite
  metric: INSTRUCTION

# Per-package thresholds
# Package names are relative to com.sichrplace.backend.*
packages:

  service:
    target: 25           # Current: 32.1 %
    aspiration: 95
    description: "Business logic — highest priority for coverage"
    critical_classes:
      - UserServiceImpl
      - ApartmentServiceImpl
      - ViewingRequestServiceImpl
      - ConversationServiceImpl
      - ReviewServiceImpl
      - NotificationServiceImpl
      - FavoriteServiceImpl
      - SavedSearchServiceImpl
      - AdminServiceImpl

  dto:
    target: 5            # Current: 8.2 %
    aspiration: 95
    description: "DTO fromEntity() mapping — must be fully tested"

  security:
    target: 15           # Current: 22.3 %
    aspiration: 90
    description: "JWT provider, auth filter, security config"
    critical_classes:
      - JwtTokenProvider
      - JwtAuthenticationFilter
      - CustomUserDetailsService

  controller:
    target: 8            # Current: 10.3 %
    aspiration: 80
    description: "REST endpoints — test request/response contracts"
    critical_classes:
      - UserController
      - ApartmentController
      - ViewingRequestController
      - ConversationController
      - ReviewController
      - SavedSearchController
      - AdminController

  repository:
    target: 0            # Repositories are Spring-generated interfaces (no code to cover)
    aspiration: 80
    description: "Custom JPA query methods"

  model:
    target: 12           # Current: 18.1 %
    aspiration: 70
    description: "Entity classes — mostly Lombok, test custom logic only"
    notes: "Lombok-generated getters/setters are excluded from coverage"

  config:
    target: 20           # Current: 23.5 %
    aspiration: 60
    description: "DataSeeder, CORS, Swagger — test that they initialise"
    critical_classes:
      - DataSeeder
